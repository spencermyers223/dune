# Sui Chain Configuration
# Reference for Sui-specific Dune patterns

name: Sui
status: partial-support  # strong-support | partial-support | no-support

# What's available
coverage:
  raw_tables: true        # sui.transactions, sui.events, etc. ARE accessible
  curated_spellbooks: false  # No dex_sui.trades, lending.*, prices.* for Sui
  community_datasets: true   # 50+ community datasets available

# Namespace mappings
namespaces:
  dex: null                   # No dex_sui tables exist
  aggregator: null
  prices: null                # Use community Pyth oracle datasets
  raw_transactions: sui.transactions
  raw_events: sui.events
  raw_objects: sui.objects
  raw_move_calls: sui.move_call
  raw_checkpoints: sui.checkpoints

# Raw table schemas (verified)
raw_tables:
  sui.transactions:
    columns:
      - transaction_digest
      - checkpoint
      - epoch
      - timestamp_ms
      - date
      - sender
    notes: "Main transaction table - use for DAU, tx counts. NO volume/value columns - for volume data use DefiLlama API or decode sui.events"

  sui.events:
    columns: []  # Needs verification
    notes: "Raw blockchain events"

  sui.objects:
    columns: []  # Needs verification
    notes: "Sui objects/state"

  sui.move_call:
    columns: []  # Needs verification
    notes: "Move function calls - useful for protocol-specific analysis"

# Query patterns for this chain
patterns:
  blockchain_filter: false    # No need for WHERE blockchain = 'sui'
  address_column: sender      # In sui.transactions
  timestamp_column: date      # Date column (also timestamp_ms for ms precision)
  date_column: date

# Important notes for query writing
gotchas:
  - "Raw tables ARE accessible - sui.transactions, sui.events work"
  - "NO curated spellbooks - no dex_sui.trades, no prices.usd for Sui"
  - "sui.transactions does NOT contain volume/value data - only tx metadata"
  - "For volume data, use DefiLlama API or decode sui.events transfer amounts"
  - "Use INTERVAL 'X' DAY syntax (not WEEK)"
  - "Community datasets available for protocols (Bluefin, DeepBook, Scallop)"
  - "For TVL data, use DefiLlama API - not available in Dune"
  - "Protocol-specific trades require parsing raw events or community datasets"

# Protocol coverage in Dune
known_protocols:
  dex:
    - name: Cetus
      dune_coverage: community-datasets-only
      api: "https://api.mainnet.cetus.zone"
      docs: "https://docs.cetus.zone/api"

    - name: DeepBook
      dune_coverage: community-datasets-only
      community_tables:
        - "0xhipo - deepbook_pools_params"
        - "0xhipo - deepbook_market_info"
      docs: "https://docs.sui.io/guides/developer/app-examples/deepbook"

  perps:
    - name: Bluefin
      dune_coverage: community-datasets-only
      community_tables:
        - "openblo... - bluefin_account_event"
      api: "https://dapi.bluefin.io"
      docs: "https://docs.bluefin.io/developers"

  lending:
    - name: Navi
      dune_coverage: community-datasets-only
      api: "https://app.naviprotocol.io/api"
      docs: "https://docs.naviprotocol.io/developers"

    - name: Scallop
      dune_coverage: community-datasets-only
      community_tables:
        - "sc_research - sui_collateral_value"
        - "sc_research - sui_deposit_value"
        - "sc_research - sui_staking"
      docs: "https://docs.scallop.io"

# Community datasets (most useful)
community_datasets:
  price_data:
    - "dune.dourol.pyth_price_feed_txn_sui (11.41 GB)"
    - "dune.miladzm71.suipricetable"
    - "dune.index_.sui_oracle_historical_pri"

  network_analytics:
    - "dune.fourpillars.sui_network"
    - "dune.fourpillars.sui_validators"

  user_analytics:
    - "dune.goodheat.sui_wallet_data"
    - "dune.goodheat.sui_new_user_info"

# Example queries
query_examples:
  daily_transactions: |
    SELECT
      DATE_TRUNC('day', date) AS day,
      COUNT(*) AS tx_count
    FROM sui.transactions
    WHERE date >= CURRENT_DATE - INTERVAL '30' DAY
    GROUP BY DATE_TRUNC('day', date)
    ORDER BY day DESC

  weekly_active_users: |
    SELECT
      DATE_TRUNC('week', date) AS week_start,
      COUNT(DISTINCT sender) AS weekly_active_users
    FROM sui.transactions
    WHERE date >= CURRENT_DATE - INTERVAL '365' DAY
    GROUP BY DATE_TRUNC('week', date)
    ORDER BY week_start ASC

  weekly_transactions: |
    SELECT
      DATE_TRUNC('week', date) AS week_start,
      COUNT(*) AS weekly_transactions
    FROM sui.transactions
    WHERE date >= CURRENT_DATE - INTERVAL '365' DAY
    GROUP BY DATE_TRUNC('week', date)
    ORDER BY week_start ASC

# Alternative data sources (for data not in Dune)
alternatives:
  tvl_data:
    source: "DefiLlama API"
    endpoint: "https://api.llama.fi/v2/historicalChainTvl/Sui"
    notes: "No TVL tables in Dune for Sui - use DefiLlama"

  indexers:
    - name: Sui Indexer
      url: "https://docs.sui.io/guides/developer/getting-started/sui-indexer"
      description: "Official Sui indexer for transaction data"

    - name: SuiVision
      url: "https://suivision.xyz"
      description: "Block explorer with API access"

    - name: Suiscan
      url: "https://suiscan.xyz"
      description: "Alternative block explorer"

  protocol_apis:
    cetus: "https://api.mainnet.cetus.zone"
    bluefin: "https://dapi.bluefin.io"
    navi: "https://app.naviprotocol.io/api"

notes:
  - "Sui has PARTIAL Dune support - raw tables work, no spellbooks"
  - "For protocol-specific metrics, combine raw tables + community datasets + APIs"
  - "Community datasets use format: dune.creator_name.table_name"
  - "See schemas/sui.md for full list of available tables and datasets"

last_updated: "2025-01-17"
